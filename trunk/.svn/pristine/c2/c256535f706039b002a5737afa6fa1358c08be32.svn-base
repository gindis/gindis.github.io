define("category/index",["common/js/util","common/js/jsbridge","module/js/net","module/js/loading","module/js/modal","./views/category-render","./views/item-render","module/js/fastclick"],function(e,o,t){"use strict";function s(){this.init.apply(this,arguments)}var i,a,n,_,c,d,G,r,O,L,m=e("common/js/util"),l=(e("common/js/jsbridge"),e("module/js/net")),u=e("module/js/loading");e("module/js/modal");O=50,L=!1;var A=e("./views/category-render"),N=e("./views/item-render"),p=e("module/js/fastclick");p(document.body),n=new u({content:"加载中..."}),i=new l,a=new Object,a=m.getRequest(!1),_=a.id,c=a.deviceType,d=a.accessToken,r=a.choose,G="click",($.os.android||$.os.ios)&&(G="tap"),"undefined"==typeof _GLOBAL_CONFIG_&&(window._GLOBAL_CONFIG_={}),_&&(_GLOBAL_CONFIG_.id=_),d&&(_GLOBAL_CONFIG_.accessToken=d),_GLOBAL_CONFIG_.PAGE={startRow:0,startTime:null,hasNextPage:!0},s.prototype={init:function(){var e=this;e._loadData(),e._bindEvent()},_loadData:function(e){r=r?Number(r):0,i.ajax("topicDetail",{id:_GLOBAL_CONFIG_.id,choose:r,accessToken:_GLOBAL_CONFIG_.accessToken},function(e){var o,t=$("body");e.choose=r,t.append(A(e)),n.hide(),0==r?o=e.dynamics:1==r&&(o=e.products),_GLOBAL_CONFIG_.PAGE.startTime=o.firstTime,_GLOBAL_CONFIG_.PAGE.hasNextPage=o.hasNextPage,_GLOBAL_CONFIG_.PAGE.startRow+=o.pageSize})},_bindEvent:function(){$(window).scroll(function(){var e=$(window).scrollTop(),o=parseFloat($(window).height())+parseFloat(e),t=$(document).height();!L&&o>=t-O&&_GLOBAL_CONFIG_.PAGE.hasNextPage&&(L=!0,i.ajax("topicDetail",{id:_GLOBAL_CONFIG_.id,choose:r,accessToken:_GLOBAL_CONFIG_.accessToken,startRow:_GLOBAL_CONFIG_.PAGE.startRow,startTime:_GLOBAL_CONFIG_.PAGE.startTime},function(e){e.choose=r;var o,t=N(e);$("#columns").append(t),0==r?o=e.dynamics:1==r&&(o=e.products),_GLOBAL_CONFIG_.PAGE.startTime=o.firstTime,_GLOBAL_CONFIG_.PAGE.hasNextPage=o.hasNextPage,_GLOBAL_CONFIG_.PAGE.startRow+=o.pageSize,L=!1}))})}},t.exports=s});