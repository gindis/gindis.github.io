define("detail/index",["zepto","flipsnap","common/js/util","module/js/net","module/js/modal","module/views/about-render","./views/slide-render","./views/matchgoods-render","./views/hotpost-render","./views/recpost-render","./views/post-render","./views/talent-render","./views/similar-render","module/js/fastclick"],function(e,t,n){"use strict";function i(){this.init.apply(this,arguments)}var o=e("zepto"),d=e("flipsnap"),a=e("common/js/util"),s=e("module/js/net"),r=e("module/js/modal"),l=e("module/views/about-render"),c=e("./views/slide-render"),p=e("./views/matchgoods-render"),u=e("./views/hotpost-render"),_=e("./views/recpost-render"),f=e("./views/post-render"),m=e("./views/talent-render"),v=e("./views/similar-render"),h=e("module/js/fastclick");h(document.body);var w=new s,g=new Object;g=a.getRequest(!1),_GLOBAL_CONFIG_.id||(_GLOBAL_CONFIG_.id=g.id);var G="click";(o.os.android||o.os.ios)&&(G="tap"),i.prototype={init:function(){var e=this;e.loadData(),e.bindEvent()},slide:function(){if(!(o(".J_slide").length<=0)){var e=o(".J_slide .item");if(e.length<=0)return void o(".J_dots").remove();var t=window.innerWidth,n=o(".J_dots span");e.length<=1||(e.width(t),o(".J_slide").width(t*e.length),window.flipsnap=d(".J_slide",{distance:window.innerWidth,transitionDuration:100}),flipsnap.element.addEventListener("fstouchstart",function(e){},!1),flipsnap.element.addEventListener("fspointmove",function(){n.filter(".current").removeClass("current"),n.eq(flipsnap.currentPoint).addClass("current")},!1))}},renderSlide:function(e){o(".J_slideWrap").append(c(e))},goodsDetail:function(){var e=this;w.ajax("goodsDetail",{id:_GLOBAL_CONFIG_.id},function(t){o(c(t)).appendTo(".J_slideWrap"),e.slide(),w.ajax("similarGoods",{categoryId:t.categoryId,colorId:t.colorId,deviceType:"h5"},function(e){o(v(e)).appendTo(".J_similar")})}),w.ajax("recPost",{id:_GLOBAL_CONFIG_.id},function(e){o(_(e)).appendTo(".J_recPost")}),w.ajax("postChart",{},function(e){o(f(e)).appendTo(".J_post")}),w.ajax("userHot",{},function(e){o(m(e)).appendTo(".J_talent")})},goReg:function(){new r({content:"需要注册才能执行该操作",button:[{title:"取消"},{title:"注册"}],callback:function(e,t){1==t&&(location.href="./reg.html")}})},goodsMacth:function(){w.ajax("macthGoods",{id:_GLOBAL_CONFIG_.id},function(e){o(p(e.match)).appendTo(".J_content"),w.ajax("hotPost",{id:_GLOBAL_CONFIG_.id},function(t){t.username=e.match.user.name,o(u(t)).appendTo(".J_hot"),document.title=o(".name").text()+"发布的搭配";var n=o(".J_mark");n.length>0&&n.on(G,function(){var e=o(this);e.hasClass("on")?(e.children(".mark").fadeIn(),e.removeClass("on")):(e.addClass("on"),e.children(".mark").fadeOut())})})})},loadData:function(e){var t=this;"goodsDetail"==_GLOBAL_CONFIG_.pageId?t.goodsDetail():"goodsMacth"==_GLOBAL_CONFIG_.pageId&&t.goodsMacth(),o(l()).appendTo(".J_about"),a.initDownload()},bindEvent:function(){var e=this;o(".J_reg").live(G,function(){e.goReg()})}},n.exports=i});